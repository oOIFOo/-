#ifndef _LIBAS_DEVAPP_H_
#define _LIBAS_DEVAPP_H_

#include <jni.h>
#include <android/log.h>
#include <vector>
#include <assert.h>
#include <string.h>
#include <stdarg.h>
#include <stdio.h>
#include <stdlib.h>

#define DEBUG_TAG "DevApp-NDK"

#define SHOW_DEBUG_MESSAGE true

#define JNI_FUNC_NAME(name) Java_umich_cse_yctung_devapp_JNICallback_ ## name
#define JNI_FUNC_HEAD extern "C"
#define JNI_FUNC_PARAM JNIEnv *env, jobject obj,
#define JNI_FUNC_NO_PARAM JNIEnv *env, jobject obj

#define DEBUG_MACRO(x) __android_log_print(ANDROID_LOG_DEBUG, DEBUG_TAG, "%s", x);
#define DEBUG_MACRO_WARN(x) __android_log_print(ANDROID_LOG_WARN, DEBUG_TAG, "[WARN]: %s", x);
#define DEBUG_MACRO_ERROR(x) __android_log_print(ANDROID_LOG_ERROR, DEBUG_TAG, "[ERROR]: %s", x);
#define DEBUG_MACRO_ASSERT(x) __android_log_print(ANDROID_LOG_ERROR, DEBUG_TAG, "[ASSERT FAIL]: %s", x);
#define DEBUG_STRING_BUFFER_SIZE 1024

void debug(const char *s,...);
void warn(const char *s,...);
void error(const char *s,...);

extern "C" void JNI_FUNC_NAME(debugTest)(JNI_FUNC_NO_PARAM);
extern "C" void JNI_FUNC_NAME(dataCallback)(JNI_FUNC_PARAM jlong retAddr);


// TODO: remove it, just for analyzing latency
void makeConvolveInDestSize(float *source, int sourceSize, float *filter, int filterSize, float *dest, int destSize, bool returnAbs);
int AUDIO_PULSE_USED_LEN = 600; // NOTE: only used the middle part of pulse to detect
float AUDIO_PULSE_USED_TO_FILTER[] = {-2.456169E-02,2.196005E-01,-4.067566E-01,5.786331E-01,-7.283136E-01,8.496487E-01,-9.375208E-01,9.880747E-01,-9.989034E-01,9.691798E-01,-8.997268E-01,7.930209E-01,-6.531263E-01,4.855606E-01,-2.970941E-01,9.549075E-02,1.108020E-01,-3.130014E-01,5.023618E-01,-6.705573E-01,8.100553E-01,-9.144667E-01,9.788546E-01,-9.999863E-01,9.765160E-01,-9.090870E-01,8.003449E-01,-6.548607E-01,4.789615E-01,-2.804753E-01,6.839869E-02,1.474999E-01,-3.571242E-01,5.505221E-01,-7.183633E-01,8.524005E-01,-9.458900E-01,9.939509E-01,-9.938425E-01,9.451436E-01,-8.498213E-01,7.121834E-01,-5.387107E-01,3.377763E-01,-1.192611E-01,-1.059181E-01,3.263457E-01,-5.306844E-01,7.082638E-01,-8.496487E-01,9.471580E-01,-9.953044E-01,9.911285E-01,-9.344074E-01,8.277207E-01,-6.763679E-01,4.881354E-01,-2.729217E-01,4.223779E-02,1.913948E-01,-4.151171E-01,6.164412E-01,-7.839565E-01,9.079923E-01,-9.811984E-01,9.990081E-01,-9.599531E-01,8.658070E-01,-7.215456E-01,5.351187E-01,-3.170424E-01,7.983037E-02,1.627070E-01,-3.962580E-01,6.068542E-01,-7.817148E-01,9.100397E-01,-9.837016E-01,9.977906E-01,-9.509755E-01,8.456521E-01,-6.878634E-01,4.869915E-01,-2.552318E-01,6.877911E-03,2.425433E-01,-4.772355E-01,6.821367E-01,-8.438994E-01,9.517826E-01,-9.983952E-01,9.802384E-01,-8.980045E-01,7.566069E-01,-5.649298E-01,3.353089E-01,-8.276831E-02,-1.759414E-01,4.234426E-01,-6.428991E-01,8.191729E-01,-9.398916E-01,9.963485E-01,-9.841693E-01,9.036915E-01,-7.600230E-01,5.627658E-01,-3.254168E-01,6.447711E-02,2.016711E-01,-4.540489E-01,6.744357E-01,-8.466993E-01,9.580034E-01,-9.998004E-01,9.685310E-01,-8.659708E-01,6.991889E-01,-4.801111E-01,2.247099E-01,4.812716E-02,-3.179741E-01,5.643891E-01,-7.684717E-01,9.143341E-01,-9.903731E-01,9.902366E-01,-9.134033E-01,7.653188E-01,-5.570671E-01,3.045905E-01,-2.750839E-02,-2.523807E-01,5.128029E-01,-7.327866E-01,8.943718E-01,-9.841112E-01,9.942352E-01,-9.233774E-01,7.767886E-01,-5.660103E-01,3.080201E-01,-2.390684E-02,-2.628241E-01,5.281837E-01,-7.497124E-01,9.084035E-01,-9.903731E-01,9.881250E-01,-9.012934E-01,7.367854E-01,-5.082970E-01,2.352284E-01,5.891985E-02,-3.485434E-01,6.081550E-01,-8.146393E-01,9.493418E-01,-9.998004E-01,9.609562E-01,-8.357210E-01,6.348362E-01,-3.760166E-01,8.244191E-02,2.192810E-01,-5.015120E-01,7.381127E-01,-9.068913E-01,9.917275E-01,-9.841693E-01,8.843412E-01,-7.010598E-01,4.511283E-01,-1.578577E-01,-1.510622E-01,4.461522E-01,-6.989547E-01,8.847995E-01,-9.852531E-01,9.900070E-01,-8.980045E-01,7.176794E-01,-4.662617E-01,1.681981E-01,1.471759E-01,-4.484956E-01,7.054838E-01,-8.920154E-01,9.888192E-01,-9.855320E-01,8.818827E-01,-6.878634E-01,4.228491E-01,-1.137311E-01,-2.077622E-01,5.082970E-01,-7.563927E-01,9.257484E-01,-9.980847E-01,9.651873E-01,-8.299197E-01,6.060729E-01,-3.170424E-01,-6.550397E-03,3.300582E-01,-6.185022E-01,8.403670E-01,-9.710863E-01,9.958279E-01,-9.112577E-01,7.260654E-01,-4.601662E-01,1.426390E-01,1.913948E-01,-5.046257E-01,7.617232E-01,-9.333533E-01,9.995847E-01,-9.522837E-01,7.962024E-01,-5.486067E-01,2.374561E-01,1.016833E-01,-4.296635E-01,7.082638E-01,-9.046708E-01,9.953990E-01,-9.691798E-01,8.284551E-01,-5.892681E-01,2.795320E-01,6.415026E-02,-4.007638E-01,6.897629E-01,-8.959776E-01,9.939509E-01,-9.711645E-01,8.297370E-01,-5.863535E-01,2.704000E-01,7.950389E-02,-4.201761E-01,7.091880E-01,-9.101754E-01,9.974754E-01,-9.594930E-01,8.003449E-01,-5.395382E-01,2.096840E-01,1.474999E-01,-4.864193E-01,7.634182E-01,-9.424372E-01,9.997803E-01,-9.273501E-01,7.339000E-01,-4.440992E-01,9.549075E-02,2.662984E-01,-5.934939E-01,8.424908E-01,-9.797167E-01,9.862447E-01,-8.605152E-01,6.187595E-01,-2.930259E-01,-7.297253E-02,4.296635E-01,-7.283136E-01,9.277173E-01,-9.999549E-01,9.344074E-01,-7.394371E-01,4.414562E-01,-8.146265E-02,-2.905197E-01,6.223551E-01,-8.671151E-01,9.897748E-01,-9.723240E-01,8.165344E-01,-5.439430E-01,1.930019E-01,1.862487E-01,-5.392624E-01,8.148292E-01,-9.725531E-01,9.888680E-01,-8.606820E-01,6.060729E-01,-2.618759E-01,-1.215370E-01,4.875636E-01,-7.817148E-01,9.597693E-01,-9.945128E-01,8.800229E-01,-6.328096E-01,2.895794E-01,9.809863E-02,-4.714689E-01,7.734777E-01,-9.575325E-01,9.947835E-01,-8.787754E-01,6.267036E-01,-2.770153E-01,-1.163339E-01,4.921321E-01,-7.914220E-01,9.667962E-01,-9.900070E-01,8.566533E-01,-5.871491E-01,2.237524E-01,1.759414E-01,-5.480589E-01,8.326505E-01,-9.834058E-01,9.753013E-01,-8.089015E-01,5.105517E-01,-1.283611E-01,-2.754415E-01,6.345831E-01,-8.896345E-01,9.979192E-01,-9.407831E-01,7.269656E-01,-3.914412E-01,-1.015301E-02,4.106425E-01,-7.425163E-01,9.493418E-01,-9.954615E-01,8.722879E-01,-6.000640E-01,2.247099E-01,1.897872E-01,-5.722044E-01,8.563152E-01,-9.924268E-01,9.562004E-01,-7.531700E-01,4.180945E-01,-9.170492E-03,-4.019638E-01,7.427356E-01,-9.524834E-01,9.933617E-01,-8.573284E-01,5.678989E-01,-1.762638E-01,-2.476238E-01,6.274690E-01,-8.943718E-01,9.994087E-01,-9.227475E-01,6.775732E-01,-3.080201E-01,-1.186107E-01,5.240057E-01,-8.331942E-01,9.884747E-01,-9.603193E-01,7.531700E-01,-4.049606E-01,-1.965007E-02,4.411623E-01,-7.800781E-01,9.719401E-01,-9.797167E-01,8.011297E-01,-4.694459E-01,4.747287E-02,3.841959E-01,-7.425163E-01,9.580034E-01,-9.883255E-01,8.268006E-01,-5.040600E-01,8.244191E-02,3.559002E-01,-7.249384E-01,9.516821E-01,-9.907324E-01,8.335563E-01,-5.105517E-01,8.537921E-02,3.574301E-01,-7.292107E-01,9.549455E-01,-9.885243E-01,8.223536E-01,-4.892784E-01,5.630402E-02,3.887270E-01,-7.548910E-01,9.667962E-01,-9.802384E-01,7.916222E-01,-4.391037E-01,-4.912813E-03,4.484956E-01,-7.991652E-01,9.832270E-01,-9.614080E-01,7.374494E-01,-3.577359E-01,-9.809863E-02,5.337345E-01,-8.564843E-01,9.970896E-01,-9.247545E-01,6.541178E-01,-2.425433E-01,-2.218366E-01,6.388764E-01,-9.180094E-01,9.980234E-01,-8.606820E-01,5.351187E-01,-9.190386E-02,-3.720678E-01,7.546762E-01,-9.710863E-01,9.727053E-01,-7.583175E-01,3.748023E-01,9.288222E-02,-5.403653E-01,8.671151E-01,-9.991076E-01,9.057842E-01,-6.073747E-01,1.707804E-01,3.052143E-01,-7.121834E-01,9.567738E-01,-9.822578E-01,7.819190E-01,-4.010639E-01,-7.297253E-02,5.306844E-01,-8.656430E-01,9.993273E-01,-8.997268E-01,5.892681E-01,-1.400451E-01,-3.427040E-01,7.451431E-01,-9.717085E-01,9.679578E-01,-7.339000E-01,3.244875E-01,1.630301E-01,-6.120475E-01,9.144667E-01,-9.968346E-01,8.384088E-01,-4.766598E-01,-1.310088E-03,4.795364E-01,-8.412535E-01,9.974754E-01,-9.090870E-01,5.969153E-01,-1.371259E-01,-3.571242E-01,7.634182E-01,-9.804323E-01,9.533771E-01,-6.881011E-01,2.501616E-01,2.511128E-01,-6.897629E-01,9.548482E-01,-9.786531E-01,7.542462E-01,-3.377763E-01,-1.652917E-01,6.267036E-01,-9.280836E-01,9.914306E-01,-7.995588E-01,4.010639E-01,1.016833E-01,-5.786331E-01,9.056454E-01,-9.969122E-01,8.277207E-01,-4.414562E-01,-6.120836E-02,5.483328E-01,-8.912740E-01,9.987611E-01,-8.414306E-01,4.601662E-01,4.420109E-02,-5.373303E-01,8.870780E-01,-9.990081E-01,8.421378E-01,-4.578383E-01,-5.074413E-02,5.461398E-01,-8.936381E-01,9.980234E-01,-8.299197E-01,4.343895E-01,8.080977E-02,-5.743512E-01,9.100397E-01,-9.945128E-01,8.034757E-01,-3.890287E-01,-1.342054E-01,6.205590E-01,-9.338228E-01,9.855320E-01,-7.602358E-01,3.204572E-01,2.103245E-01,-6.821367E-01,9.608655E-01,-9.665447E-01,6.966087E-01,-2.272623E-01,-3.077084E-01,7.548910E-01,-9.852531E-01,9.315786E-01,-6.084149E-01,1.085232E-01,4.234426E-01,-8.326505E-01,9.992148E-01,-8.735661E-01,4.915618E-01,3.536502E-02,-5.524346E-01,9.068913E-01,-9.932482E-01,7.849721E-01,-3.430117E-01,-2.016711E-01,6.866739E-01,-9.665447E-01,9.565831E-01,-6.588121E-01,1.620606E-01,3.841959E-01,-8.146393E-01,9.981847E-01,-8.781495E-01,4.901350E-01,4.812716E-02,-5.722044E-01,9.210982E-01,-9.868338E-01,7.481932E-01,-2.779593E-01,-2.789030E-01,7.497124E-01,-9.876165E-01,9.176193E-01,-5.605980E-01,2.750839E-02,5.147698E-01,-8.955408E-01,9.941294E-01,-7.784360E-01,3.157996E-01,2.476238E-01,-7.327866E-01,9.846303E-01,-9.218615E-01,5.635778E-01,-2.390684E-02,-5.240057E-01,9.034108E-01,-9.910849E-01,7.576766E-01,-2.779593E-01,-2.927127E-01,7.684717E-01,-9.934743E-01,8.931967E-01,-4.995272E-01,-5.891985E-02,5.984908E-01,-9.407831E-01,9.717858E-01,-6.802185E-01,1.620606E-01,4.106425E-01,-8.466993E-01,9.996568E-01,-8.172900E-01,3.598759E-01,2.192810E-01};


#endif /* _LIBAS_DEVAPP_H_ */
